// 1) Create the DeviceProcessEvents table (skip if it already exists)
.create table DeviceProcessEvents (
    Timestamp: datetime,
    HostName: string,
    UserName: string,
    InitiatingProcessFileName: string,
    FileName: string,
    ProcessCommandLine: string,
    FileVersion: string,
    ProductVersion: string
)

// 2) Inline ingest simulated rows (Notepad++ v8.8.3 + other versions)
.ingest inline into table DeviceProcessEvents <|
2025-10-29T16:00:00Z,HOST-01,alice,explorer.exe,notepad++.exe,"C:\Program Files\Notepad++\notepad++.exe","8.8.3","8.8.3"
2025-10-29T16:01:00Z,HOST-02,bob,explorer.exe,notepad++.exe,"C:\Users\Public\Notepad++\notepad++.exe","8.8.3","8.8.3"   // suspicious - user-writable path
2025-10-29T16:02:00Z,HOST-03,charlie,cmd.exe,notepad++.exe,"C:\Temp\Notepad++\notepad++.exe","8.8.3","8.8.3"           // portable copy from Temp - highly suspicious
2025-10-29T16:05:00Z,HOST-01,alice,explorer.exe,notepad++.exe,"C:\Program Files\Notepad++\notepad++.exe","8.6.9","8.6.9" // older version - benign
2025-10-29T16:07:00Z,HOST-04,david,explorer.exe,notepad++.exe,"D:\Tools\Notepad++\notepad++.exe","8.8.3","8.8.3"         // portable tools drive - maybe suspicious
2025-10-29T16:10:00Z,HOST-05,emma,word.exe,notepad++.exe,"C:\Program Files\Notepad++\notepad++.exe","8.8.2","8.8.2"      // previous version - benign
2025-10-29T16:12:00Z,HOST-06,frank,explorer.exe,notepad++.exe,"C:\Program Files\Notepad++\notepad++.exe","8.8.3","8.8.3"
2025-10-29T16:15:00Z,HOST-07,grace,powershell.exe,notepad++.exe,"C:\Users\Public\Notepad++Portable\notepad++.exe","8.8.3","8.8.3" // portable copy - suspicious
2025-10-29T16:20:00Z,HOST-08,harry,explorer.exe,calc.exe,"C:\Windows\System32\calc.exe","10.0.22621","10.0.22621"         // benign unrelated process
2025-10-29T16:25:00Z,HOST-09,ivan,explorer.exe,notepad++.exe,"C:\Program Files\Notepad++\notepad++.exe","8.8.3","8.8.3"
