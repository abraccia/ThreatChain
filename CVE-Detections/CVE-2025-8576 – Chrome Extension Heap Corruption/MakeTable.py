import random

def generate_DeviceID(amount, size):
    IDList = []
    for _ in range(amount):
        DeviceNumber = ''
        for _ in range(size):
            Option1 = random.randint(49, 57)
            Option2 = random.randint(65, 90)
            Option3 = random.randint(97, 122)
            Choice = random.randint(1, 3)
            if Choice == 1:
                DeviceNumber += chr(Option1)
            elif Choice == 2:
                DeviceNumber += chr(Option2)
            elif Choice == 3:
                DeviceNumber += chr(Option3)
        IDList.append(DeviceNumber)
    return IDList

def AccountNamesBase(IDs, Names, Browser, BrowserVersion):
    DeviceEvents = []
    for index in range(len(Names)):
        BrowserInput = None
        VersionInput = None
        CoinFlipBrowser = random.randint(1, 2)
        CoinFlipVersion = random.randint(1, 2)
        if CoinFlipBrowser == 1:
            BrowserInput = Browser[0]
        else:
            BrowserInput = Browser[random.randint(0, 3)]
        if CoinFlipVersion == 1:
            VersionInput = BrowserVersion[random.randint(2, 4)]
        else:
            VersionInput = BrowserVersion[random.randint(0, 4)]
        UserInfoTuple = (IDs[index], Names[index], BrowserInput, VersionInput)
        DeviceEvents.append(UserInfoTuple)
    return DeviceEvents

def TVMExtensionTable(IDs, Extensions):
    DeviceTvmBrowserExtensions = []
    for id in IDs:
        for _ in range(3):
            CoinFlipExtensions = random.randint(1, 2)
            if CoinFlipExtensions == 1:
                Ext = Extensions[random.randint(3, 5)]
            else:
                Ext = Extensions[random.randint(0, 5)]
            Entry = (id, Ext)
            DeviceTvmBrowserExtensions.append(Entry)
    return DeviceTvmBrowserExtensions

def main():
    # Generates random as example. In a practical application, replace with actual list of device IDs
    IDList = generate_DeviceID(30, 15)
    # List of preset names, please change to fit respective needs
    AccountNames = ['Noah', 'James', 'Evelyn', 'Harper', 'Michael', 'Logan', 'Avery', 'Madison', 'Riley', 'Jayden', 'Ainsley', 'Arden', 'Dakota', 'Finley', 'Hayden', 'Lennox', 'Lindsey', 'Robin', 'Rowan', 'Sloan', 'Adair', 'Averill', 'Blythe', 'Bronte', 'Brooklyn', 'Chandler', 'Kelcey', 'Mackenzie', 'Peyton', 'Sinclair']
    Browsers = ['Chrome', 'Firefox', 'Opera', 'Brave']
    BrowserVersion = ['139.0.7258.66', '140.0.7339.18', '136.0.7103.150', '137.0.7151.51', '132.0.6834.226']
    DeviceEvents = AccountNamesBase(IDList, AccountNames, Browsers, BrowserVersion)
    file = open("DeviceEvents.csv", "x")
    file.close()
    with open("DeviceEvents.csv", "a") as f:
        f.write('DeviceID,AccountName,Browsername,Browserversion')
        f.write('\n')
    for entry in DeviceEvents:
        with open("DeviceEvents.csv", "a") as f:
            f.write(str(entry[0]) + ',' + str(entry[1]) + ',' + str(entry[2]) + ',' + str(entry[3]))
            f.write('\n')
    # Start creating DeviceTvmBrowserExtensions
    file = open("DeviceTvmBrowserExtensions.csv", "x")
    file.close()
    Extensions = ['ublockorigin.exe', 'grammerly.exe', 'extensity.exe', 'myhouse.exe', 'onetab.exe', 'puzzlepieces.exe']
    # myhouse.exe and puzzlepieces.exe are considered the "malicious extensions" we want to query for
    DeviceTvmBrowserExtensions = TVMExtensionTable(IDList, Extensions)
    with open("DeviceTvmBrowserExtensions.csv", "a") as f:
        f.write('DeviceID,ExtensionName')
        f.write('\n')
    for entry in DeviceTvmBrowserExtensions:
        with open("DeviceTvmBrowserExtensions.csv", "a") as f:
            f.write(str(entry[0]) + ',' + str(entry[1]))
            f.write('\n')

if __name__ == '__main__':
    main()